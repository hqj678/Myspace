{"ast":null,"code":"import actions from './action';\nimport jwt_decode from 'jwt-decode';\nimport $ from 'jquery';\n\nconst reducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    user: {\n      username: \"\",\n      id: 1,\n      photo: \"\",\n      followCount: 0,\n      access: \"\",\n      refresh: \"\",\n      is_login: false\n    }\n  };\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case actions.Login:\n      console.log(state);\n      return { ...state,\n        user: {\n          username: \"111\",\n          id: 1,\n          photo: \"\",\n          followCount: 0,\n          access: \"\",\n          refresh: \"\",\n          is_login: false\n        }\n      };\n    // $.ajax({\n    //   url: \"https://app165.acapp.acwing.com.cn/api/token/\",\n    //   type: \"POST\",\n    //   data: {\n    //     username: action.username,\n    //     password: action.password,\n    //   },\n    //   success(resp) {\n    //     const {access, refresh} = resp;\n    //     const access_obj = jwt_decode(access);\n    //     setInterval(() => {\n    //       $.ajax({\n    //         url: \"https://app165.acapp.acwing.com.cn/api/token/refresh/\",\n    //         type: \"POST\",\n    //         data: {\n    //           refresh,\n    //         },\n    //         success(resp) {\n    //           console.log(resp)\n    //           console.log(state)\n    //           return {\n    //             ...state,\n    //             user: {\n    //               username: \"11\",\n    //               id: 1,\n    //               photo: \"\",\n    //               followCount: 0,\n    //               access: \"\",\n    //               refresh: \"\",\n    //               is_login: false,\n    //             }\n    //           }\n    //         }\n    //       })\n    //     }, 1000);\n    //     $.ajax({\n    //       url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\n    //       type: \"GET\",\n    //       data: {\n    //         user_id: access_obj.user_id,\n    //       },\n    //       headers: {\n    //         'Authorization': 'Bearer ' + access,\n    //       },\n    //       success(resp) {\n    //         return {\n    //           ...state,\n    //           ...resp,\n    //           access: access,\n    //           refresh: refresh,\n    //           is_login: true\n    //         }\n    //       },\n    //     })          \n    //   },\n    //   error() {\n    //     console.log(\"error\")\n    //   }\n    // })\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;","map":{"version":3,"names":["actions","jwt_decode","$","reducer","state","user","username","id","photo","followCount","access","refresh","is_login","action","type","Login","console","log"],"sources":["D:/Desk/web应用课/react/myspace/src/redux/reducer.js"],"sourcesContent":["import actions from './action';\r\nimport jwt_decode from 'jwt-decode'\r\nimport $ from 'jquery'\r\n\r\nconst reducer = (state = {\r\n  user: {\r\n    username: \"\",\r\n    id: 1,\r\n    photo: \"\",\r\n    followCount: 0,\r\n    access: \"\",\r\n    refresh: \"\",\r\n    is_login: false,\r\n  }\r\n}, action) => {\r\n  switch(action.type) {\r\n    case actions.Login:\r\n      console.log(state)\r\n      return {\r\n        ...state,\r\n        user: {\r\n          username: \"111\",\r\n          id: 1,\r\n          photo: \"\",\r\n          followCount: 0,\r\n          access: \"\",\r\n          refresh: \"\",\r\n          is_login: false,\r\n        }\r\n      }\r\n      // $.ajax({\r\n      //   url: \"https://app165.acapp.acwing.com.cn/api/token/\",\r\n      //   type: \"POST\",\r\n      //   data: {\r\n      //     username: action.username,\r\n      //     password: action.password,\r\n      //   },\r\n      //   success(resp) {\r\n      //     const {access, refresh} = resp;\r\n      //     const access_obj = jwt_decode(access);\r\n\r\n      //     setInterval(() => {\r\n      //       $.ajax({\r\n      //         url: \"https://app165.acapp.acwing.com.cn/api/token/refresh/\",\r\n      //         type: \"POST\",\r\n      //         data: {\r\n      //           refresh,\r\n      //         },\r\n      //         success(resp) {\r\n      //           console.log(resp)\r\n      //           console.log(state)\r\n      //           return {\r\n      //             ...state,\r\n      //             user: {\r\n      //               username: \"11\",\r\n      //               id: 1,\r\n      //               photo: \"\",\r\n      //               followCount: 0,\r\n      //               access: \"\",\r\n      //               refresh: \"\",\r\n      //               is_login: false,\r\n      //             }\r\n      //           }\r\n      //         }\r\n      //       })\r\n      //     }, 1000);\r\n\r\n      //     $.ajax({\r\n      //       url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\r\n      //       type: \"GET\",\r\n      //       data: {\r\n      //         user_id: access_obj.user_id,\r\n      //       },\r\n      //       headers: {\r\n      //         'Authorization': 'Bearer ' + access,\r\n      //       },\r\n      //       success(resp) {\r\n      //         return {\r\n      //           ...state,\r\n      //           ...resp,\r\n      //           access: access,\r\n      //           refresh: refresh,\r\n      //           is_login: true\r\n      //         }\r\n      //       },\r\n      //     })          \r\n      //   },\r\n      //   error() {\r\n      //     console.log(\"error\")\r\n      //   }\r\n      // })\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default reducer"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,UAApB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,CAAP,MAAc,QAAd;;AAEA,MAAMC,OAAO,GAAG,YAUF;EAAA,IAVGC,KAUH,uEAVW;IACvBC,IAAI,EAAE;MACJC,QAAQ,EAAE,EADN;MAEJC,EAAE,EAAE,CAFA;MAGJC,KAAK,EAAE,EAHH;MAIJC,WAAW,EAAE,CAJT;MAKJC,MAAM,EAAE,EALJ;MAMJC,OAAO,EAAE,EANL;MAOJC,QAAQ,EAAE;IAPN;EADiB,CAUX;EAAA,IAAXC,MAAW;;EACZ,QAAOA,MAAM,CAACC,IAAd;IACE,KAAKd,OAAO,CAACe,KAAb;MACEC,OAAO,CAACC,GAAR,CAAYb,KAAZ;MACA,OAAO,EACL,GAAGA,KADE;QAELC,IAAI,EAAE;UACJC,QAAQ,EAAE,KADN;UAEJC,EAAE,EAAE,CAFA;UAGJC,KAAK,EAAE,EAHH;UAIJC,WAAW,EAAE,CAJT;UAKJC,MAAM,EAAE,EALJ;UAMJC,OAAO,EAAE,EANL;UAOJC,QAAQ,EAAE;QAPN;MAFD,CAAP;IAYA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IACF;MACE,OAAOR,KAAP;EA7EJ;AA+ED,CA1FD;;AA4FA,eAAeD,OAAf"},"metadata":{},"sourceType":"module"}