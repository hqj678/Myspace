{"ast":null,"code":"var _jsxFileName = \"D:\\\\Desk\\\\web\\u5E94\\u7528\\u8BFE\\\\react\\\\myspace\\\\src\\\\ajax\\\\ajax.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { Component } from 'react';\nimport $ from 'jquery';\nimport jwt_decode from 'jwt-decode';\nimport { useDispatch } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst LOGIN = (username, password) => {\n  _s();\n\n  const dispatch = useDispatch();\n  $.ajax({\n    url: \"https://app165.acapp.acwing.com.cn/api/token/\",\n    type: \"POST\",\n    data: {\n      username,\n      password\n    },\n\n    success(resp) {\n      const {\n        access,\n        refresh\n      } = resp;\n      const access_obj = jwt_decode(access); // setInterval(() => {\n      //   $.ajax({\n      //     url: \"https://app165.acapp.acwing.com.cn/api/token/refresh/\",\n      //     type: \"POST\",\n      //     data: {\n      //       refresh,\n      //     },\n      //     success(resp) {\n      //       dispatch({\n      //         type: 'updateAccess',\n      //         access\n      //       })\n      //     }\n      //   })\n      // }, 4.5*60*1000);\n\n      $.ajax({\n        url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\n        type: \"GET\",\n        data: {\n          user_id: access_obj.user_id\n        },\n        headers: {\n          'Authorization': 'Bearer ' + access\n        },\n\n        success(resp) {\n          console.log(resp);\n          dispatch({\n            type: \"updateUser\",\n            username: resp.username,\n            id: resp.id,\n            photo: resp.photo,\n            followCount: resp.followCount,\n            access: access,\n            refresh: refresh,\n            is_login: true\n          });\n        }\n\n      });\n    }\n\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n\n_s(LOGIN, \"rgTLoBID190wEKCp9+G8W6F7A5M=\", false, function () {\n  return [useDispatch];\n});\n\n_c = LOGIN;\nexport default LOGIN;\nusername, password;\n\nvar _c;\n\n$RefreshReg$(_c, \"LOGIN\");","map":{"version":3,"names":["React","Component","$","jwt_decode","useDispatch","LOGIN","username","password","dispatch","ajax","url","type","data","success","resp","access","refresh","access_obj","user_id","headers","console","log","id","photo","followCount","is_login"],"sources":["D:/Desk/web应用课/react/myspace/src/ajax/ajax.jsx"],"sourcesContent":["import React, { Component } from 'react';\r\nimport $ from 'jquery'\r\nimport jwt_decode from 'jwt-decode'\r\nimport { useDispatch } from 'react-redux'; \r\n\r\nconst LOGIN = (username, password) => {\r\n\r\n  const dispatch = useDispatch()\r\n\r\n  $.ajax({\r\n    url: \"https://app165.acapp.acwing.com.cn/api/token/\",\r\n    type: \"POST\",\r\n    data: {\r\n      username,\r\n      password\r\n    },\r\n    success(resp) {\r\n      const {access, refresh} = resp;\r\n      const access_obj = jwt_decode(access);\r\n\r\n      // setInterval(() => {\r\n      //   $.ajax({\r\n      //     url: \"https://app165.acapp.acwing.com.cn/api/token/refresh/\",\r\n      //     type: \"POST\",\r\n      //     data: {\r\n      //       refresh,\r\n      //     },\r\n      //     success(resp) {\r\n      //       dispatch({\r\n      //         type: 'updateAccess',\r\n      //         access\r\n      //       })\r\n      //     }\r\n      //   })\r\n      // }, 4.5*60*1000);\r\n\r\n      $.ajax({\r\n        url: \"https://app165.acapp.acwing.com.cn/myspace/getinfo/\",\r\n        type: \"GET\",\r\n        data: {\r\n          user_id: access_obj.user_id,\r\n        },\r\n        headers: {\r\n          'Authorization': 'Bearer ' + access,\r\n        },\r\n        success(resp) {\r\n          console.log(resp)\r\n          dispatch({\r\n            type: \"updateUser\",\r\n            username: resp.username,\r\n            id: resp.id,\r\n            photo: resp.photo,\r\n            followCount: resp.followCount,\r\n            access: access,\r\n            refresh: refresh,\r\n            is_login: true\r\n          })\r\n        }\r\n      })          \r\n    },\r\n  })\r\n  return ( \r\n    <div></div>\r\n   );\r\n}\r\n \r\nexport default LOGIN;username, password"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAASC,WAAT,QAA4B,aAA5B;;;AAEA,MAAMC,KAAK,GAAG,CAACC,QAAD,EAAWC,QAAX,KAAwB;EAAA;;EAEpC,MAAMC,QAAQ,GAAGJ,WAAW,EAA5B;EAEAF,CAAC,CAACO,IAAF,CAAO;IACLC,GAAG,EAAE,+CADA;IAELC,IAAI,EAAE,MAFD;IAGLC,IAAI,EAAE;MACJN,QADI;MAEJC;IAFI,CAHD;;IAOLM,OAAO,CAACC,IAAD,EAAO;MACZ,MAAM;QAACC,MAAD;QAASC;MAAT,IAAoBF,IAA1B;MACA,MAAMG,UAAU,GAAGd,UAAU,CAACY,MAAD,CAA7B,CAFY,CAIZ;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MAEAb,CAAC,CAACO,IAAF,CAAO;QACLC,GAAG,EAAE,qDADA;QAELC,IAAI,EAAE,KAFD;QAGLC,IAAI,EAAE;UACJM,OAAO,EAAED,UAAU,CAACC;QADhB,CAHD;QAMLC,OAAO,EAAE;UACP,iBAAiB,YAAYJ;QADtB,CANJ;;QASLF,OAAO,CAACC,IAAD,EAAO;UACZM,OAAO,CAACC,GAAR,CAAYP,IAAZ;UACAN,QAAQ,CAAC;YACPG,IAAI,EAAE,YADC;YAEPL,QAAQ,EAAEQ,IAAI,CAACR,QAFR;YAGPgB,EAAE,EAAER,IAAI,CAACQ,EAHF;YAIPC,KAAK,EAAET,IAAI,CAACS,KAJL;YAKPC,WAAW,EAAEV,IAAI,CAACU,WALX;YAMPT,MAAM,EAAEA,MAND;YAOPC,OAAO,EAAEA,OAPF;YAQPS,QAAQ,EAAE;UARH,CAAD,CAAR;QAUD;;MArBI,CAAP;IAuBD;;EAlDI,CAAP;EAoDA,oBACE;IAAA;IAAA;IAAA;EAAA,QADF;AAGD,CA3DD;;GAAMpB,K;UAEaD,W;;;KAFbC,K;AA6DN,eAAeA,KAAf;AAAqBC,QAAQ,EAAEC,QAAV"},"metadata":{},"sourceType":"module"}